# WorldWeaver 使い方マニュアル

WorldWeaver は、創作・設定管理に特化した次世代の Wiki システムです。直感的な操作と、地図・年表・相関図などの多角的な視覚化機能を備えています。

---

## 1. 基本操作

### 記事の閲覧
- **フォルダ階層**: 画面左側のサイドバーからフォルダを辿り、記事を探すことができます。
- **全文検索**: 上部の検索バーにキーワードを入力すると、タイトルや本文から記事を検索できます。
- **タグフィルタ**: 記事に設定されたタグをクリックすることで、同じタグを持つ記事を絞り込むことができます。

### 表示モード（ビュー）の切り替え
画面上部のタブから、以下のビューに切り替えることができます：
- **一覧**: フォルダ階層による整理された記事リスト。
- **地図**: 記事に設定された地点を表示します。複数のレイヤー（大陸図、詳細図など）を切り替えることが可能です。
- **構造年表**: 出来事を時系列に並べて表示します。
- **相関図**: 記事間のリンクに基づき、人物や組織のつながりを可視化します。
- **データ**: 記事のメタデータを一覧表形式で表示・確認できます。

---

## 2. 記事の作成と編集

### 新規作成
1. 画面右上の「+ 新規作成」ボタン（またはフォルダ内のボタン）をクリックします。
2. テンプレートを選択します（人物、国、組織、出来事、思想など）。
3. タイトル、フォルダ、本文を入力します。

### 編集
- 記事の右上の「編集」ボタンから編集画面に移行します。
- 保存すると、管理者の承認を経て公開されます（設定により即時公開の場合もあります）。

### メタデータの設定
- **年代**: 年表の並び順に影響します。
- **重要度**: 相関図でのノードの大きさや、フィルタリングに影響します。
- **地点**: 地図上に表示する座標（緯度・経度）を登録できます。

---

## 3. Wiki 記法とプラグイン

WorldWeaver では、WYSIWYG エディタに加え、以下の Wiki 記法（PukiWiki 互換）を使用できます。

### 基本記法
- **リンク**: `[[記事名]]` または `[[表示名|記事ID]]`
- **太字**: `''テキスト''`
- **斜体**: `'''テキスト'''`
- **見出し**: `*`, `**`, `***` （行頭に記述）
- **引用**: `>` （行頭に記述）
- **折り畳み**: `#fold(タイトル){内容}`

### 特殊プラグイン
- **高度な表組み**:
  ```
  |~見出し1|~見出し2|
  |データ1|データ2|
  ```
- **Googleスプレッドシート埋め込み**:
  `#googlesheet(URL)`
- **自動集計テーブル**:
  `#datatable(folder=フォルダ名, tag=タグ名)`
  指定した条件に合致する記事のデータを自動的に表形式で集計します。

---

## 4. 管理者向け機能

管理者権限（Owner/Admin）を持つユーザーは以下の機能を利用できます。

### 承認プロセス
- 一般ユーザーからの編集リクエストを「管理パネル」または各記事の「保存」時に確認・承認できます。

### メンバー管理
- ユーザーIDを指定して、メンバーの追加や権限（閲覧、編集、管理者）の変更が行えます。

### 地図設定と地域ルール
- **地図レイヤー**: 背景となる地図画像の URL や名称を管理できます。
- **地域ルール**: 地図上の特定の範囲（矩形・円）にタグを関連付けることで、その範囲内に地点を持つ記事へタグを自動付与できます。

### システム設定
- Firebase の API キーや App ID を GUI 上で変更できます。

---

## 5. FAQ / トラブルシューティング

- **記事が地図に表示されない**: 「地点」エディタで正しい緯度・経度が設定されているか確認してください。
- **リンクが赤くなる**: リンク先の記事が存在しない、または ID が間違っている場合に赤く表示されます。

---

> [!TIP]
> 記事を作成する際は、適切な **年代** と **フォルダ分け** を行うことで、年表や地図の利便性が大幅に向上します。
